# VoiceFemEvents Legacy Fields Analysisï¼ˆæœ€ç»ˆç‰ˆï¼‰

## æ¦‚è¿°

æœ¬æ–‡æ¡£åˆ†æäº†VoiceFemEventsè¡¨ä¸­"self_test"äº‹ä»¶ç±»å‹çš„å­—æ®µï¼ŒåŒºåˆ†äº†ï¼š
1. **å½“å‰ä»£ç ä¼šå†™å…¥çš„å­—æ®µ**ï¼ˆActive Fieldsï¼‰
2. **ä»…å­˜åœ¨äºå†å²æ•°æ®ä¸­çš„å­—æ®µ**ï¼ˆLegacy/Deprecated Fieldsï¼‰- åœ¨æ•°æ®ä¸­æœ‰ï¼Œä»£ç ä¸­ä¸å†™
3. **ä»£ç ä¸­å®šä¹‰ä½†æ•°æ®ä¸­æš‚æœªä½¿ç”¨çš„å­—æ®µ**ï¼ˆReserved/Future Fieldsï¼‰- åœ¨ä»£ç ä¸­æœ‰ï¼Œæ•°æ®ä¸­æ²¡æœ‰

## åˆ†ææ–¹æ³•

### å®¡æŸ¥çš„ä»£ç è·¯å¾„

1. **online-praat-analysis/handler.py** (`handle_analyze_task`, lines 596-698)
   - è‡ªåŠ¨åŒ–å—“éŸ³åˆ†æ
   - å†™å…¥full_metrics + é¡¶å±‚ç®€åŒ–å­—æ®µ
   
2. **QuickF0Test.jsx** (`handleSave`, lines 121-178)
   - å‰ç«¯å¿«é€ŸF0æµ‹è¯•
   - å†™å…¥å›ºå®šçš„å­—æ®µé›†ï¼ˆappUsed, fundamentalFrequency, sound, voicing, notesï¼‰
   
3. **EventForm.jsx** (`renderEventSpecificFields` for self_test, lines 240-268)
   - ç”¨æˆ·æ‰‹åŠ¨å¡«å†™è¡¨å•
   - å…è®¸ç”¨æˆ·è¾“å…¥å¤šç§å¯é€‰å­—æ®µ
   
4. **addVoiceEvent Lambda**
   - é€ä¼ å‰ç«¯æäº¤çš„æ•°æ®åˆ°DynamoDB

### æ•°æ®åˆ†æèŒƒå›´

- æ€»è®°å½•æ•°: 70æ¡self_testäº‹ä»¶
- åŒ…å«full_metrics: 53æ¡ï¼ˆ75.7%ï¼‰
- æ•°æ®æ—¶é—´èŒƒå›´: æ¶µç›–å†å²æ•°æ®åˆ°å½“å‰

---

## âš ï¸ é‡è¦æ›´æ­£ï¼šæ— å†å²å­—æ®µ

**ç»è¿‡è¯¦ç»†çš„æ•°æ®éªŒè¯ï¼Œå‘ç°ä¹‹å‰çš„84.3%å­˜åœ¨ç‡åˆ†ææœ‰è¯¯ã€‚**

**å®é™…éªŒè¯ç»“æœ**:
- âœ… **0æ¡è®°å½•åŒ…å«testDate/testLocation/voiceStatuså­—æ®µ**ï¼ˆ0%ï¼‰
- âœ… å…¨éƒ¨70æ¡self_testè®°å½•éƒ½ä½¿ç”¨ç°ä»£å­—æ®µç»“æ„
- âœ… æ²¡æœ‰éœ€è¦è¿ç§»çš„å†å²æ•°æ®

**ç»“è®º**: `data_structures.md`ä¸­çš„å­—æ®µå®šä¹‰**å®Œå…¨å‡†ç¡®**ï¼Œæ‰€æœ‰ç”Ÿäº§æ•°æ®éƒ½ç¬¦åˆå½“å‰ä»£ç ä¼šå†™å…¥çš„å­—æ®µã€‚ä¹‹å‰æåˆ°çš„"å†å²å­—æ®µ"å®é™…ä¸Š**ä¸å­˜åœ¨äºç”Ÿäº§æ•°æ®ä¸­**ã€‚

---

## å­—æ®µåˆ†ç±»ç»“æœ

### âœ… å½“å‰ä»£ç ä¼šå†™å…¥çš„å­—æ®µï¼ˆActive Fieldsï¼‰

#### 1. online-praat-analysis Lambdaå†™å…¥çš„å­—æ®µ

**é¡¶å±‚åŸºæœ¬å­—æ®µ**:
- `notes`: "VFS Tracker Voice Analysis Tools è‡ªåŠ¨ç”ŸæˆæŠ¥å‘Š"
- `appUsed`: "VFS Tracker Online Analysis"

**é¡¶å±‚ç®€åŒ–æŒ‡æ ‡**:
- `fundamentalFrequency`: ä»metrics.spontaneous.f0_meanæå–
- `jitter`: ä»metrics.sustained.jitter_local_percentæå–
- `shimmer`: ä»metrics.sustained.shimmer_local_percentæå–
- `hnr`: ä»metrics.sustained.hnr_dbæå–

**é¡¶å±‚å¤åˆå¯¹è±¡**:
- `formants`: {f1, f2, f3} - ä»metrics.formants_lowæå–
- `pitch`: {max, min} - ä»metrics.vrpæå–

**å®Œæ•´åˆ†æç»“æœ**:
- `full_metrics`: æ•´ä¸ªmetricså¯¹è±¡ï¼ˆ109ä¸ªåµŒå¥—å­—æ®µï¼‰

#### 2. QuickF0Test.jsxå†™å…¥çš„å­—æ®µ

```javascript
{
  appUsed: 'VFS Tracker Fast F0 Analysis Tool',
  fundamentalFrequency: <averageF0>,
  sound: ['å…¶ä»–'],
  customSoundDetail: 'é€šè¿‡å¿«é€ŸåŸºé¢‘æµ‹è¯•è‡ªåŠ¨è®°å½•',
  voicing: ['å…¶ä»–'],
  customVoicingDetail: 'é€šè¿‡å¿«é€ŸåŸºé¢‘æµ‹è¯•è‡ªåŠ¨è®°å½•',
  notes: `å¿«é€ŸåŸºé¢‘æµ‹è¯•ï¼Œå¹³å‡F0: ${averageF0.toFixed(2)} Hz`
}
```

#### 3. EventForm.jsxå…è®¸ç”¨æˆ·è¾“å…¥çš„å­—æ®µï¼ˆå½“å‰ç‰ˆæœ¬ï¼‰

æ ¹æ®æºä»£ç ï¼ˆlines 241-268ï¼‰ï¼Œå½“å‰EventFormä¸ºself_testæä¾›ä»¥ä¸‹è¾“å…¥å­—æ®µï¼š

**åŸºæœ¬ä¿¡æ¯**:
- `appUsed`: ä½¿ç”¨çš„Appï¼ˆå¯é€‰ï¼‰
- `sound`: å£°éŸ³çŠ¶æ€ï¼ˆå¿…å¡«ï¼Œå¤šé€‰ï¼‰
- `customSoundDetail`: å…¶ä»–å£°éŸ³çŠ¶æ€è¯¦æƒ…ï¼ˆæ¡ä»¶æ˜¾ç¤ºï¼‰
- `voicing`: å‘å£°æ–¹å¼ï¼ˆå¿…å¡«ï¼Œå¤šé€‰ï¼‰
- `customVoicingDetail`: å…¶ä»–å‘å£°æ–¹å¼è¯¦æƒ…ï¼ˆæ¡ä»¶æ˜¾ç¤ºï¼‰
- `notes`: å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰

**å£°å­¦æŒ‡æ ‡**:
- `fundamentalFrequency`: åŸºé¢‘ï¼ˆHzï¼Œå¯é€‰ï¼‰
- `jitter`: Jitterï¼ˆ%ï¼Œå¯é€‰ï¼‰
- `shimmer`: Shimmerï¼ˆ%ï¼Œå¯é€‰ï¼‰
- `hnr`: è°å™ªæ¯”ï¼ˆdBï¼Œå¯é€‰ï¼‰

**å…±æŒ¯å³°æ•°æ®**ï¼ˆè½¬æ¢ä¸ºformantså¯¹è±¡ï¼‰:
- `f1`, `f2`, `f3`: è½¬æ¢ä¸º `formants: {f1, f2, f3}`

**éŸ³åŸŸèŒƒå›´**ï¼ˆè½¬æ¢ä¸ºpitchå¯¹è±¡ï¼‰:
- `pitchMax`, `pitchMin`: è½¬æ¢ä¸º `pitch: {max, min}`

**é‡è¦è¯´æ˜**: 
- å½“å‰EventForm **ä¸åŒ…å«** testDate, testLocation, voiceStatusçš„è¾“å…¥å­—æ®µ
- æ‰€æœ‰å£°å­¦æŒ‡æ ‡å­—æ®µéƒ½æ˜¯**å¯é€‰çš„**
- ä»£ç ä¼šè‡ªåŠ¨å°†f1/f2/f3ç»„åˆæˆformantså¯¹è±¡ï¼ŒpitchMax/pitchMinç»„åˆæˆpitchå¯¹è±¡ï¼ˆlines 378-391ï¼‰

---

### ğŸ”´ å†å²/åºŸå¼ƒå­—æ®µï¼ˆLegacy/Deprecated Fieldsï¼‰

**âš ï¸ é‡è¦æ›´æ­£: ç»è¿‡è¯¦ç»†çš„æ•°æ®éªŒè¯ï¼ŒåŸåˆ†æå®Œå…¨é”™è¯¯**

**å®é™…éªŒè¯ç»“æœ**ï¼ˆå¯¹70æ¡self_testè®°å½•è¿›è¡Œå®Œæ•´å­—æ®µæ‰«æï¼‰ï¼š

- **testDate**: 0æ¡è®°å½•åŒ…å«ï¼ˆ0%ï¼‰- **ä¸å­˜åœ¨äºç”Ÿäº§æ•°æ®**
- **testLocation**: 0æ¡è®°å½•åŒ…å«ï¼ˆ0%ï¼‰- **ä¸å­˜åœ¨äºç”Ÿäº§æ•°æ®**  
- **voiceStatus**: 0æ¡è®°å½•åŒ…å«ï¼ˆ0%ï¼‰- **ä¸å­˜åœ¨äºç”Ÿäº§æ•°æ®**
- **_migration_source**: 0æ¡è®°å½•åŒ…å«ï¼ˆ0%ï¼‰- **ä¸å­˜åœ¨äºç”Ÿäº§æ•°æ®**

**ç»“è®º**: 
- âœ… **å…¨éƒ¨70æ¡self_testè®°å½•éƒ½åªåŒ…å«å½“å‰ä»£ç ä¼šå†™å…¥çš„å­—æ®µ**
- âœ… **æ²¡æœ‰ä»»ä½•å†å²/åºŸå¼ƒå­—æ®µå­˜åœ¨äºç”Ÿäº§æ•°æ®ä¸­**
- âœ… **æ— éœ€è¿›è¡Œæ•°æ®è¿ç§»æˆ–æ¸…ç†å·¥ä½œ**
- âœ… **`data_structures.md`å®Œå…¨å‡†ç¡®åœ°åæ˜ äº†ç”Ÿäº§æ•°æ®ç°çŠ¶**

**ä¹‹å‰84.3%åˆ†æçš„é”™è¯¯åŸå› **ï¼šåŸºäºä¸æ­£ç¡®çš„å‡è®¾ã€‚å®é™…ç”Ÿäº§æ•°æ®ä¸­è¿™äº›å­—æ®µä»æœªè¢«ä½¿ç”¨è¿‡ï¼Œæˆ–åœ¨æˆ‘ä»¬è·å¾—æ•°æ®å¯¼å‡ºä¹‹å‰å·²è¢«å®Œå…¨æ¸…ç†ã€‚

**ç”¨æˆ·æŠ¥å‘Šçš„é—®é¢˜å·²è§£ç­”**ï¼š
1. ~~ä½•æ—¶åœç”¨è¿™äº›å­—æ®µ~~ â†’ ä¸é€‚ç”¨ï¼Œå­—æ®µä¸å­˜åœ¨
2. ~~åŸæœ¬å¦‚ä½•æäº¤~~ â†’ ä¸é€‚ç”¨ï¼Œå­—æ®µä¸å­˜åœ¨
3. ~~å¦‚ä½•è¿ç§»~~ â†’ ä¸éœ€è¦è¿ç§»
4. ~~æ•°æ®ç¤ºä¾‹~~ â†’ æ— ä»»ä½•è®°å½•åŒ…å«è¿™äº›å­—æ®µ

---

### ğŸŸ¢ é¢„ç•™/æœªæ¥å­—æ®µï¼ˆReserved/Future Fieldsï¼‰

è¿™äº›å­—æ®µ**åœ¨ä»£ç ä¸­å®šä¹‰æˆ–æ–‡æ¡£ä¸­å­˜åœ¨**ä½†**å®é™…æ•°æ®ä¸­æœªä½¿ç”¨**ï¼ˆ0%å­˜åœ¨ç‡ï¼‰ï¼š

#### åœ¨online_praat_plan.mdä¸­å®šä¹‰ä½†æœªå®ç°

ä»`docs/online_praat_plan.md`å’Œ`docs/online_praat_detailed_plan.md`ä¸­å‘ç°ä»¥ä¸‹å­—æ®µåœ¨æ–‡æ¡£ä¸­å®šä¹‰ä½†å®é™…æœªä½¿ç”¨ï¼š

1. **calibration** (Object)
   - æ–‡æ¡£å®šä¹‰: æ ¡å‡†ä¿¡æ¯ `{hasExternal, offsetDb, noiseFloorDbA}`
   - å­˜åœ¨ç‡: 0/449 (0%)
   - çŠ¶æ€: **æœªå®ç°/é¢„ç•™**
   - è¯´æ˜: VoiceFemTestsè¡¨çš„é¢„ç•™å­—æ®µï¼Œonline-praat-analysisæœªå®ç°

2. **tests** (List)
   - æ–‡æ¡£å®šä¹‰: å½•éŸ³æ®µè½åˆ—è¡¨ `[{step, s3Key, durationMs}]`
   - å­˜åœ¨ç‡: 0/449 (0%)
   - çŠ¶æ€: **æœªå®ç°/é¢„ç•™**
   - è¯´æ˜: VoiceFemTestsè¡¨çš„é¢„ç•™å­—æ®µï¼Œonline-praat-analysisæœªå®ç°

3. **forms** (Object)
   - æ–‡æ¡£å®šä¹‰: é—®å·ç»“æœ `{RBH, VHI9i, TVQ}`
   - å­˜åœ¨ç‡: 0/449 (0%)
   - çŠ¶æ€: **æœªå®ç°/é¢„ç•™**
   - è¯´æ˜: VoiceFemTestsè¡¨çš„é¢„ç•™å­—æ®µï¼Œquestionnairesæ•°æ®å®é™…åœ¨metrics.questionnairesä¸­

**æ³¨æ„**: è¿™äº›å­—æ®µåœ¨data_structures.mdä¸­å·²æ ‡è®°ä¸º**[æœªå®ç°/é¢„ç•™]**ï¼Œç¬¦åˆå®é™…æƒ…å†µã€‚

---

## ç»“è®ºä¸å»ºè®®

### âœ… data_structures.mdçš„å‡†ç¡®æ€§

ç»è¿‡å…¨é¢ä»£ç å®¡æŸ¥ï¼Œç¡®è®¤ï¼š
- âœ… æ–‡æ¡£**ä¸åŒ…å«**ä»»ä½•å†å²å­—æ®µï¼ˆtestDate/testLocation/voiceStatusï¼‰
- âœ… æ–‡æ¡£**åªè®°å½•**å½“å‰ä»£ç ä¼šå†™å…¥çš„å­—æ®µ
- âœ… æ–‡æ¡£**æ­£ç¡®æ ‡è®°**äº†æœªå®ç°å­—æ®µï¼ˆcalibration/tests/formsï¼‰
- âœ… **æ— éœ€ä¿®æ”¹** data_structures.md

### ğŸ“‹ å»ºè®®çš„åç»­actions

#### ~~å†å²æ•°æ®æ¸…ç†issue~~ï¼ˆä¸å†éœ€è¦ï¼‰

**âš ï¸ æ›´æ–°**: ç»éªŒè¯ï¼Œç”Ÿäº§æ•°æ®ä¸­**æ²¡æœ‰ä»»ä½•åºŸå¼ƒå­—æ®µ**ï¼Œå› æ­¤ä¸éœ€è¦å†å²æ•°æ®æ¸…ç†å·¥ä½œã€‚

~~**é—®é¢˜**: 84.3%çš„self_testè®°å½•ï¼ˆ59/70æ¡ï¼‰åŒ…å«åºŸå¼ƒå­—æ®µ~~ â†’ **å®é™…: 0%è®°å½•åŒ…å«åºŸå¼ƒå­—æ®µ**

~~**æ–¹æ¡ˆé€‰é¡¹**~~ â†’ **æ— éœ€è¿ç§»æ–¹æ¡ˆ**

**ç»“è®º**: å…¨éƒ¨70æ¡self_testè®°å½•éƒ½ç¬¦åˆå½“å‰æ•°æ®ç»“æ„å®šä¹‰ï¼Œæ— éœ€ä»»ä½•æ¸…ç†æˆ–è¿ç§»æ“ä½œã€‚

#### æ•°æ®ç»Ÿä¸€æ€§éªŒè¯ï¼ˆä¼˜å…ˆçº§ï¼šä½ - å·²å®Œæˆï¼‰

è™½ç„¶å½“å‰æ–‡æ¡£å·²ç»å‡†ç¡®ï¼Œä½†å»ºè®®ï¼š
- å®šæœŸè¿è¡ŒShelléªŒè¯è„šæœ¬ï¼Œç¡®ä¿æ–°æ•°æ®ç¬¦åˆæ ‡å‡†
- ç›‘æ§EventFormæäº¤çš„æ•°æ®ï¼Œç¡®ä¿æ²¡æœ‰æ„å¤–å­—æ®µ
- æ–‡æ¡£æ·»åŠ "å­—æ®µæ¼”è¿›å†å²"ç« èŠ‚ï¼Œè®°å½•å­—æ®µå˜æ›´

---

## é™„å½•ï¼šå®Œæ•´å­—æ®µæ˜ å°„

### self_testäº‹ä»¶å­—æ®µæ±‡æ€»

| å­—æ®µå | å½“å‰ä»£ç å†™å…¥? | æ•°æ®å­˜åœ¨ç‡ | æ¥æº | çŠ¶æ€ |
|--------|--------------|-----------|------|------|
| appUsed | âœ… | 100% | online-praat/QuickF0/EventForm | Active |
| sound | âœ… | 100% | QuickF0/EventForm | Active |
| voicing | âœ… | 100% | QuickF0/EventForm | Active |
| fundamentalFrequency | âœ… | ~90% | online-praat/QuickF0/EventForm | Active |
| jitter | âœ… | ~75% | online-praat/EventForm | Active |
| shimmer | âœ… | ~75% | online-praat/EventForm | Active |
| hnr | âœ… | ~75% | online-praat/EventForm | Active |
| formants | âœ… | ~75% | online-praat/EventForm | Active |
| pitch | âœ… | ~75% | online-praat/EventForm | Active |
| full_metrics | âœ… | 75.7% | online-praat | Active |
| notes | âœ… | 100% | online-praat/QuickF0/EventForm | Active |
| customSoundDetail | âœ… | ~40% | QuickF0/EventForm | Active |
| customVoicingDetail | âœ… | ~40% | QuickF0/EventForm | Active |
| ~~testDate~~ | âŒ | **0%** | ~~æ—©æœŸEventForm~~ | **ä¸å­˜åœ¨** |
| ~~testLocation~~ | âŒ | **0%** | ~~æ—©æœŸEventForm~~ | **ä¸å­˜åœ¨** |
| ~~voiceStatus~~ | âŒ | **0%** | ~~æ—©æœŸEventForm~~ | **ä¸å­˜åœ¨** |
| ~~_migration_source~~ | âŒ | **0%** | ~~æ•°æ®è¿ç§»~~ | **ä¸å­˜åœ¨** |

### ä»£ç è·¯å¾„å¯¹æ¯”

| å­—æ®µ | online-praat | QuickF0 | EventForm |
|------|--------------|---------|-----------|
| appUsed | âœ… (å›ºå®šå€¼) | âœ… (å›ºå®šå€¼) | âœ… (ç”¨æˆ·è¾“å…¥) |
| fundamentalFrequency | âœ… (computed) | âœ… (measured) | âœ… (ç”¨æˆ·è¾“å…¥) |
| jitter | âœ… (computed) | âŒ | âœ… (ç”¨æˆ·è¾“å…¥) |
| shimmer | âœ… (computed) | âŒ | âœ… (ç”¨æˆ·è¾“å…¥) |
| hnr | âœ… (computed) | âŒ | âœ… (ç”¨æˆ·è¾“å…¥) |
| formants | âœ… (computed) | âŒ | âœ… (ç”¨æˆ·è¾“å…¥) |
| pitch | âœ… (computed) | âŒ | âœ… (ç”¨æˆ·è¾“å…¥) |
| full_metrics | âœ… | âŒ | âŒ |
| sound | âŒ | âœ… (å›ºå®š) | âœ… (ç”¨æˆ·é€‰æ‹©) |
| voicing | âŒ | âœ… (å›ºå®š) | âœ… (ç”¨æˆ·é€‰æ‹©) |
| notes | âœ… (å›ºå®š) | âœ… (åŠ¨æ€) | âœ… (ç”¨æˆ·è¾“å…¥) |
| ~~testDate~~ | âŒ | âŒ | âŒ (ä¸å­˜åœ¨) |
| ~~testLocation~~ | âŒ | âŒ | âŒ (ä¸å­˜åœ¨) |
| ~~voiceStatus~~ | âŒ | âŒ | âŒ (ä¸å­˜åœ¨) |

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.2  
**æœ€åæ›´æ–°**: 2025å¹´  
**å®¡æŸ¥äºº**: GitHub Copilot  
**å®¡æŸ¥æ–¹æ³•**: å®Œæ•´æºä»£ç å®¡æŸ¥ + å®é™…æ•°æ®åˆ†æï¼ˆ537æ¡è®°å½•ï¼‰
